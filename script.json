const URL = "./model/";
let model, maxPredictions;

async function init() {
    const modelURL = URL + "model.json";
    const metadataURL = URL + "metadata.json";
    model = await tmImage.load(modelURL, metadataURL);
    maxPredictions = model.getTotalClasses();
}

document.getElementById("imageInput").addEventListener("change", async (event) => {
    const file = event.target.files[0];
    if (!file) return;

    const img = document.getElementById("preview");
    img.src = URL.createObjectURL(file);
    img.onload = async () => {
        const prediction = await model.predict(img);
        prediction.sort((a, b) => b.probability - a.probability);
        document.getElementById("result").innerText = 
            `Prediction: ${prediction[0].className} (${(prediction[0].probability * 100).toFixed(2)}%)`;
    };
});

init();
